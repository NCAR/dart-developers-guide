<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>DART Developer&#x27;s Guide</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="index.html">Welcome</a></li><li class="chapter-item expanded "><a href="dart-flow.html"><strong aria-hidden="true">1.</strong> DART flow</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="feature-branch.html"><strong aria-hidden="true">1.1.</strong> Feature Branch Workflow</a></li><li class="chapter-item expanded "><a href="git-setup.html"><strong aria-hidden="true">1.2.</strong> Using git</a></li><li class="chapter-item expanded "><a href="create-branch.html"><strong aria-hidden="true">1.3.</strong> Creating a feature branch</a></li><li class="chapter-item expanded "><a href="commit-messages.html"><strong aria-hidden="true">1.4.</strong> Committing your code</a></li><li class="chapter-item expanded "><a href="private.html"><strong aria-hidden="true">1.5.</strong> Public vs. Private development</a></li></ol></li><li class="chapter-item expanded "><a href="example-spec.html"><strong aria-hidden="true">2.</strong> Writing Specifications</a></li><li class="chapter-item expanded "><a href="github.html"><strong aria-hidden="true">3.</strong> GitHub</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="issues.html"><strong aria-hidden="true">3.1.</strong> Tracking tasks</a></li><li class="chapter-item expanded "><a href="bug-reports.html"><strong aria-hidden="true">3.2.</strong> Reporting bugs</a></li><li class="chapter-item expanded "><a href="reviewing.html"><strong aria-hidden="true">3.3.</strong> Pull Requests</a></li><li class="chapter-item expanded "><a href="releases.html"><strong aria-hidden="true">3.4.</strong> Creating a Release</a></li></ol></li><li class="chapter-item expanded "><a href="ideal-rotary-phone.html"><strong aria-hidden="true">4.</strong> GitHub Playground</a></li><li class="chapter-item expanded "><a href="users.html"><strong aria-hidden="true">5.</strong> Dealing with Users</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="people-debugging.html"><strong aria-hidden="true">5.1.</strong> User reported problems</a></li></ol></li><li class="chapter-item expanded "><a href="github-actions.html"><strong aria-hidden="true">6.</strong> GitHub Actions</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="github-actions-workflow.html"><strong aria-hidden="true">6.1.</strong> Workflows</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="workflow-triggers.html"><strong aria-hidden="true">6.1.1.</strong> Triggers</a></li><li class="chapter-item expanded "><a href="workflow-runners.html"><strong aria-hidden="true">6.1.2.</strong> Runners</a></li><li class="chapter-item expanded "><a href="workflow-jobs.html"><strong aria-hidden="true">6.1.3.</strong> Jobs</a></li><li class="chapter-item expanded "><a href="workflow-testing.html"><strong aria-hidden="true">6.1.4.</strong> Testing</a></li><li class="chapter-item expanded "><a href="tidbits.html"><strong aria-hidden="true">6.1.5.</strong> Tidbits</a></li></ol></li><li class="chapter-item expanded "><a href="github-actions-composites.html"><strong aria-hidden="true">6.2.</strong> Composite Actions</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="comp-act-requirements.html"><strong aria-hidden="true">6.2.1.</strong> Requirements</a></li><li class="chapter-item expanded "><a href="comp-act-usage.html"><strong aria-hidden="true">6.2.2.</strong> Usage</a></li><li class="chapter-item expanded "><a href="comp-act-yaml.html"><strong aria-hidden="true">6.2.3.</strong> Composites</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="containers.html"><strong aria-hidden="true">7.</strong> DART Docker Containers</a></li><li class="chapter-item expanded "><a href="web-and-docs.html"><strong aria-hidden="true">8.</strong> DART Web Presence</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="documentation.html"><strong aria-hidden="true">8.1.</strong> Documentation</a></li><li class="chapter-item expanded "><a href="website.html"><strong aria-hidden="true">8.2.</strong> DART website</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">9.</strong> Draft: Style Guide</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.</strong> Draft: DART</div></li><li class="chapter-item expanded affix "><a href="contributors.html">Contributors</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">DART Developer&#x27;s Guide</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/NCAR/dart-developers-guide" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="welcome-to-the-dart-developers-guide"><a class="header" href="#welcome-to-the-dart-developers-guide">Welcome to the DART Developer's Guide</a></h1>
<h2 id="goal-of-this-document"><a class="header" href="#goal-of-this-document">Goal of this document</a></h2>
<p>A <em>living</em> document to describe the DART software workflow. Our current
workflow is using GitHub.</p>
<p>Things we don't have yet:</p>
<ul>
<li>a project management system</li>
</ul>
<p>Things we do have:</p>
<ul>
<li>standups</li>
<li>issue tracking via GitHub</li>
<li>code review via pull requests on GitHub</li>
<li>this many lines of code:</li>
</ul>
<p><img src="./images/cloc.png" alt="lines-of-code" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dart-flow"><a class="header" href="#dart-flow">DART flow</a></h1>
<p><strong>DART flow</strong> is the workflow to go from having an <strong>idea</strong> for a
feature to getting the feature into the DART <strong>code</strong>, so your feature
can be used <strong>do science</strong>.</p>
<p><img src="./images/dart-flow-pic.jpg" alt="dart-flow" /></p>
<ol>
<li>
<p>Describe the problem you are trying to fix. Use GitHub
<a href="./issues.html">issues</a> to track the problem. </p>
</li>
<li>
<p>Add a label to the issue The label helps prioritize the issue. Is it
a bug fix, is it a new feature, is it refactoring existing code? Use
the label <code>back-burner</code> for something that is low priority.</p>
</li>
<li>
<p>Describe your solution in the issue. Give an estimation of how much
code this will effect. Will your solution require changing several
modules? The <a href="./example-spec.html">writing specifications</a> section of 
this document gives an example of how to describe your solution.</p>
</li>
<li>
<p>Get some feedback on your solution, the standup is a good place to
ask for volunteers. This is a good time to have an in-person meeting
to chat about your spec.</p>
</li>
<li>
<p>Create a <a href="./feature-branch.html">feature branch</a> to use for your 
solution. Once you are happy with your
feature branch, push the branch up to the main DART repo and create
a <a href="./pull_request.html">pull request</a>.</p>
</li>
<li>
<p>Be as helpful to your reviewers as you can. Only include changes
relevant to your issue and avoid changes that are not relevant to
the particular issue.</p>
</li>
<li>
<p>If your pull request is approved, merge into the main branch and
create a <a href="./releases.html">release</a>.</p>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="feature-branch-workflow"><a class="header" href="#feature-branch-workflow">Feature Branch Workflow</a></h1>
<p>DART is using a Feature Branch Workflow. </p>
<blockquote>
<p>&quot;The core idea behind the
Feature Branch Workflow is that all feature development should take
place in a dedicated branch instead of the main branch. This
encapsulation makes it easy for multiple developers to work on a
particular feature without disturbing the main codebase.&quot;</p>
</blockquote>
<p>It also means, ideally, that the main branch will never contain broken code.
Atlassian has a nice comparison of the various
<a href="https://www.atlassian.com/git/tutorials/comparing-workflows">workflows</a>
people use.</p>
<h2 id="branch-naming-conventions"><a class="header" href="#branch-naming-conventions">Branch naming conventions</a></h2>
<p><strong>main</strong></p>
<p>This is the main branch. It should always work.</p>
<p><strong>feature-branch</strong></p>
<p>Your feature branch should have a descriptive name which indicates
what bug fix or feature the branch contains. For example, a feature
branch for adding a flu forecasting model could be called:
<em>flu-model</em></p>
<p><strong>gh-pages</strong></p>
<p>This branch is used to serve the website dart.ucar.edu. It only has
the website content. To make changes to the website, follow the
instructions on <a href="https://github.com/NCAR/dart-web">https://github.com/NCAR/dart-web</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="using-git"><a class="header" href="#using-git">Using Git</a></h1>
<p>DART is under version control with Git. </p>
<h2 id="setting-up-your-git-environment"><a class="header" href="#setting-up-your-git-environment">Setting up your git environment</a></h2>
<p>Set your username and email that you want to be linked with git. What
you select here will be the 'author' information for your commits.</p>
<pre><code class="language-{.text}">git config --global user.name “Margaret Hamilton”
git config --global user.email mhamilton@nasa.gov
</code></pre>
<p>Set the editor you want to use for commit messages: vim, nano, emacs,
notepad++, whatever your favorite editor is. In this example, I am
setting my editor for commit messages to vim.</p>
<pre><code class="language-{.text}">git config --global core.editor vim
</code></pre>
<p>Note this doesn't mean you have to edit all code with vim. This just
means git will open vim when it wants you to write a commit message.</p>
<p>To display what your git settings are:</p>
<pre><code>git config --list
</code></pre>
<h2 id="setting-your-terminal-prompt-to-display-the-branch"><a class="header" href="#setting-your-terminal-prompt-to-display-the-branch">Setting your terminal prompt to display the branch</a></h2>
<p>For bash users you can add the following to your <code>~/.profile</code> file to 
display the branch you have checked out.</p>
<pre><code class="language-bash"># Git branch in prompt.

parse_git_branch() {
  git branch 2&gt; /dev/null | sed -e '/^[^*]/d' -e 's/* \(.*\)/ (\1)/'
}

export PS1=&quot;\u@\h \W\[\033[31m\]\$(parse_git_branch)\[\033[00m\] $ &quot;

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="creating-a-feature-branch"><a class="header" href="#creating-a-feature-branch">Creating a feature branch</a></h1>
<p>Create your feature branch from the main branch.</p>
<pre><code class="language-text">git clone https://github.com/NCAR/DART.git
cd DART
git checkout main
git checkout -b new-feature
</code></pre>
<p>where <em>new-feature</em> is the name of your feature branch.</p>
<p>Try not to name your branch after yourself, e.g
<em>barbara-liskov</em>. Pick a name that represents what you are
working on, e.g. <em>oop-version-of-filter</em>.</p>
<p>To push your branch up to the DART repo:</p>
<pre><code>git push -u origin new-feature  
</code></pre>
<p>Note</p>
<p>The -u flag means your local copy will track the remote repo. It is no
big deal if you don't do it, but it is nice to have <code>git status</code> tell you &quot;your branch is up to date with
remote/new_branch_name&quot; or &quot;your branch is 2 commits behind
remote/new_branch_name&quot;</p>
<h2 id="keeping-your-feature-branch-up-to-date-with-the-main"><a class="header" href="#keeping-your-feature-branch-up-to-date-with-the-main">Keeping your feature branch up to date with the main</a></h2>
<p>As you are working on your feature branch, the main branch may have been
updated.</p>
<p>To keep your feature branch up to date with the main:</p>
<pre><code>git checkout main
git pull 
git checkout new-feature 
git merge main new-feature
</code></pre>
<p>Make sure you have <a href="./commit-messages.html">committed</a> any changes to your new-feature branch
before updating from the main</p>
<p>Once your feature is ready for review, submit a
<a href="./reviewing.html">pull request</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="commititing-your-code"><a class="header" href="#commititing-your-code">Commititing your code</a></h1>
<p>How and when you commit your code can make life easier for other developers and your future self.
In general, you should aim to make your code changes easy for other members of the DART team
to review, cherry-pick, and revert. Ideally, you should:</p>
<ul>
<li>Separate functional changes from style changes</li>
<li>Write good commit messages</li>
</ul>
<h2 id="writing-good-commit-messages"><a class="header" href="#writing-good-commit-messages">Writing Good Commit Messages</a></h2>
<pre><code>one line short summary of the change

more detail if needed on why you changed what
</code></pre>
<p>For example,</p>
<pre><code>Place ring in Mount Doom

Ring is destroyed, Sauron loses his power forever. All he created collapses, 
the Nazgûl perish, and his armies are thrown into such disarray that Aragorn's
forces emerge victorious.
</code></pre>
<blockquote>
<p><strong>Be aware</strong>: commit messages are visible to the whole world on GitHub.</p>
</blockquote>
<p>You can link to github issues on <a href="https://github.com/NCAR/DART/issues">https://github.com/NCAR/DART/issues</a> from commit messages
using the #issue-number syntax, for example:</p>
<pre><code>bug-fix for #245 namelist values need to be the same type as variable
</code></pre>
<p>We do not have a strict convention such as <a href="http://commitizen.github.io/cz-cli/">commitizen</a>
enfored for commits, but you may want to start your commit with one of the following to make 
searching log files easier.</p>
<pre><code>bug-fix:
refactor:
style:
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="public-development"><a class="header" href="#public-development">Public development</a></h1>
<p>In general, all DART development is public, either on the DART
repository or a fork of the DART repository.</p>
<h2 id="private-development"><a class="header" href="#private-development">Private development</a></h2>
<p>When is it ok to use a private repo?</p>
<ul>
<li>Collaborators require a private repo for development.</li>
<li>You want to have content for the DART team only.</li>
</ul>
<p>If you want to use GitHub with a private version of the DART repo with
your collaborators. You can create a new private repository on GitHub,
for example <a href="https://github.com/your-private-repo">https://github.com/your-private-repo</a>, and use this new
private repo as a remote. Follow the same conventions for
<a href="./feature-branch.html">feature branch workflow</a>
by creating a branch for you and your collaborators to use.</p>
<pre><code>git clone https://github.com/NCAR/DART.git
cd DART
git checkout main
git checkout -b embargoed-feature
git remote add collab https://github.com/your-private-repo
git push -u collab embargoed-feature
</code></pre>
<p>In the above example,</p>
<p><a href="https://github.com/your-private-repo">https://github.com/your-private-repo</a> is the private repository.</p>
<p><strong>embargoed-feature</strong> is the branch where the private development will be done.</p>
<p><strong>collab</strong> is the name of the remote.</p>
<p>To list all the remotes you have for a repository, use</p>
<pre><code>git remote -v
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="writing-specifications"><a class="header" href="#writing-specifications">Writing Specifications</a></h1>
<blockquote>
<p>The goal is software engineering is to solve problems. 
Code is one part of this.</p>
</blockquote>
<p>A spec outlines how you are going to solve a particular technical
problem. Here are some questions to have in mind when you sit down to
write a spec:</p>
<ul>
<li>What is the problem you are trying to solve?</li>
<li>Is this the right problem to be solving?</li>
<li>What are the possible solutions to the problem?</li>
<li>What are the trade-offs for the solution you chose?</li>
<li>How should you test your solution? For each test, what is a pass,
what is a fail</li>
</ul>
<p>A good spec, has many advantages:</p>
<ul>
<li>You can get feedback on your design before you write a lot of code.</li>
<li>It allows other people to get an idea of the scope of your problem,
and prioritize the most critical parts.</li>
<li>A good spec can be the base for your documentation.</li>
<li>A spec can be used when judging how successful a particular effort
was.</li>
</ul>
<p>The drawbacks of specs:</p>
<ul>
<li>You might not really be able to think about the problem until you
start writing the code.</li>
<li>You may plan in great detail, but encounter unexpected problems that
take your code in a completely different direction.</li>
</ul>
<p>Note</p>
<p>When you write a spec, put your name on it.</p>
<p>Below is an outline of what to put in a spec with some examples.</p>
<hr />
<h2 id="front-matter"><a class="header" href="#front-matter">Front Matter</a></h2>
<p>Title: Using Zarr files with DART</p>
<p>Author: Carol Shaw</p>
<p>Date: November 5th 1982</p>
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<p>Describe the goal of the project. The big picture, why it is important,
what problem is it going to solve. An example,</p>
<blockquote>
<p>DART needs to be able to work with Zarr files because data
assimilation has become a key part of animating the next Toy Story
movie and much of the computation will be done in the cloud.</p>
</blockquote>
<h2 id="terminology"><a class="header" href="#terminology">Terminology</a></h2>
<p>Define any terminology that someone reading the spec needs to know. For
example,</p>
<p><strong>Zarr</strong> : A file format for storing chunked, compressed arrays 
that plays nicely with cloud storage.</p>
<h2 id="functional-specification"><a class="header" href="#functional-specification">Functional Specification</a></h2>
<p>This describes the expected behavior of the system. Its purpose is to
describe how a user will interact with the system. One of the uses for a
functional spec is in designing tests, because the tests should check
the expected behavior of the system.</p>
<p><strong>Default behavior</strong> : </p>
<p>What the system will do.</p>
<p><strong>User options</strong> : </p>
<p>What options a user can choose, and what is the 
expected behavior for each option.</p>
<p>You may want to write the functional spec in the form of user stories:</p>
<blockquote>
<p>Angelica Pickles is simulating a tornado with WRF and wants to output
Zarr files. She sets the namelist options <code>restart-format = Zarr</code> and runs filter.</p>
</blockquote>
<blockquote>
<p>Details about how a user interacts with the code, are probably the part
of the spec that gives you the most bang for your buck.</p>
</blockquote>
<h2 id="technical-specification"><a class="header" href="#technical-specification">Technical Specification</a></h2>
<p>This describes how the solution will be implemented. This technical spec
can be used to design unit tests. The technical spec may include
performance requirements.</p>
<h2 id="open-issues"><a class="header" href="#open-issues">Open Issues</a></h2>
<p>List any unsolved issues. This helps people reading the spec to
understand the crux(es) for the project.</p>
<h2 id="non-goals"><a class="header" href="#non-goals">Non Goals</a></h2>
<p>This describes what is out of scope for this project. For example,</p>
<blockquote>
<p>The character design for Woody in the next Toy Story movie</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="github"><a class="header" href="#github">GitHub</a></h1>
<p>DART is hosted on GitHub</p>
<p><a href="https://github.com/NCAR/DART">https://github.com/NCAR/DART</a></p>
<p>As a member of the NCAR organization you can create public and
private repositories under the NCAR GitHub organization</p>
<p><a href="https://github.com/NCAR">https://github.com/NCAR</a></p>
<p>The DART team is:</p>
<p><a href="https://github.com/orgs/NCAR/teams/dart">https://github.com/orgs/NCAR/teams/dart</a></p>
<p>If you are working with people outside the DART team, for example with
summer interns or external collaborators, you may want to create a GitHub
team to manage repository access. For example the team <a href="https://github.com/orgs/NCAR/teams/dart-siparcs">dart-siparcs</a>
was used for a 2021 SiParCS project.</p>
<p>There are four main ways developers and users interact with each other
on GitHub:</p>
<ul>
<li><a href="./issues.html">Issues</a></li>
<li><a href="./bug-reports.html">Bug reports</a></li>
<li><a href="./reviewing.html">Pull requests</a></li>
<li><a href="./releases.html">Releases</a></li>
</ul>
<p>At the top level of the DART repositroy is a directory <code>.github</code>.  This
contains the templates for pull requests and issues. </p>
<p><code>./github/pull_request_template.md</code> is the template for pull requests.</p>
<p><code>./github/ISSUE_TEMPLATE/bug_report.md</code> is the template for bug reports.</p>
<p><code>./github/ISSUE_TEMPLATE/feature_request.md</code> is the template for feature requests. </p>
<p>Blank issues are enabled on the DART repository.  The templates control what
shows up when a user clicks &quot;bug-report&quot; or &quot;feature request&quot;.</p>
<p><img src="./images/template.png" alt="templates" /></p>
<p>If you want to edit the <code>*.md</code> templates and preview the changes, try the edits
out on a fork of DART.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tracking-tasks-with-github-issues"><a class="header" href="#tracking-tasks-with-github-issues">Tracking tasks with GitHub issues</a></h1>
<p>GitHub issues are a way to keep track of enhancements, bugs, and
discussions about code. Use issues to:</p>
<ul>
<li>Report a <a href="./bug-reports.html">bug</a></li>
<li>Request/Propose a feature</li>
</ul>
<h3 id="labels"><a class="header" href="#labels">Labels</a></h3>
<p>GitHub allows issues to be labeled. Here are some you may want to use:</p>
<p><strong>Bug</strong> : Something is incorrect or not working</p>
<p><strong>Backburner</strong> : A problem that is very low priority, but might be 
worked on in the future</p>
<p><strong>Science</strong> : A problem that needs science discussion to be resolved</p>
<p>You may want to add your own labels, for example, if you are working a
lot with WRF, you may want to add the label WRF so you can search for
all issues related to WRF.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="reporting-bugs"><a class="header" href="#reporting-bugs">Reporting Bugs</a></h1>
<p>A bug report should contain the following:</p>
<ol>
<li>The steps someone needs to take to reproduce the bug.</li>
<li>What you expected to happen.</li>
<li>What actually happened.</li>
</ol>
<p>Here is an example bug report:</p>
<ol>
<li>
<p>Steps to reproduce:</p>
<ul>
<li>Use kroger brand cake mix.</li>
<li>Mix 2 cups of water with into the cake mix to produce a batter.</li>
<li>Turn on the NCAR oven in the Mesa Lab.</li>
<li>Bake the batter in a pyrex dish for 20 minutes at 350F.</li>
</ul>
</li>
<li>
<p>What I expected to happen:</p>
<p>A cake</p>
</li>
<li>
<p>What actually happened:</p>
<p>Cake batter not cooked at all.</p>
</li>
</ol>
<blockquote>
<p>Try to have a reproducer for the bug that is as small as possible. The
smallest number of observations, the fewest time steps, the lowest
resolution model.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="pull-requests"><a class="header" href="#pull-requests">Pull requests</a></h1>
<p>The main branch of DART is protected.  New code needs to be submitted as 
pull request.  At least one approval from a member of the DART team is needed
to merge code into main. The process to go from a pull request to released 
code is:</p>
<ul>
<li>review [reject, request changes, approve]</li>
<li>make required changes</li>
<li>merge</li>
<li>tag a release</li>
</ul>
<h2 id="reviewing"><a class="header" href="#reviewing">Reviewing</a></h2>
<p>The key questions to think about when reviewing pull requests:</p>
<ol>
<li>Does this pull request address the issue? If the pull request
contains other changes that are not related, it is ok to close the
pull request.</li>
<li>Has the code passed the required tests?</li>
<li>Has the documentation been updated?</li>
<li>Does the pull request improve the existing code?</li>
<li>Does this pull request break backwards compatibility? If so, now may
not be the time to merge this feature.</li>
</ol>
<p>When giving comments on code, try to give comments that:</p>
<ul>
<li>are actionable.</li>
<li>differentiate between a <em>suggestion</em>, a <em>definite change</em>, or a
point that needs a <em>discussion or clarification</em>.</li>
<li>are collaborative not accusatory.</li>
</ul>
<p>If there are a lot of comments or questions on the code, schedule and in
person meeting.</p>
<h3 id="checking-out-pull-requests"><a class="header" href="#checking-out-pull-requests">Checking out pull requests</a></h3>
<p>For pull requests that are following
<a href="./dart-flow.html">DART flow</a> you can checkout
the feature branch from the <a href="https://github.com/NCAR/DART">DART repo</a></p>
<pre><code>git fetch origin
git checkout feature-branch
</code></pre>
<p>To checkout a pull request that is not from a branch on the DART
repository, for example a pull request from an external collaborator.</p>
<pre><code>git fetch origin pull/ID/head:BRANCHNAME
git checkout BRANCHNAME
</code></pre>
<p>where ID is the number of the pull request and BRANCHNAME is your choice
for the name of the branch</p>
<h2 id="being-reviewed"><a class="header" href="#being-reviewed">Being Reviewed</a></h2>
<p>It can be quite difficult having someone review your code. Remember
software engineering is <em>programming integrated over time</em> [1]. Code reviews
are a process to produce better code and better developers. Karl
Wieger's article <a href="https://www.processimpact.com/articles/humanizing_reviews.pdf">Humanizing Peer
Reviews</a>
is a good read about overcoming some of the barriers to successful peer
review.</p>
<p>[1] WINTERS, T., MANSHRECK, T., &amp; WRIGHT, H. (2020). Software engineering at Google: lessons learned from programming over time.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="creating-a-release"><a class="header" href="#creating-a-release">Creating a Release</a></h1>
<p>The DART releases are available on GitHub:</p>
<p><a href="https://github.com/NCAR/DART/releases">https://github.com/NCAR/DART/releases</a></p>
<p>The releases loosely follows the rules of <a href="https://semver.org/">semantic
versioning</a> with a v at the start, e.g. v9.10.11.</p>
<pre><code>vMAJOR.MINOR.PATCH
</code></pre>
<p>Given a version number vMAJOR.MINOR.PATCH, increment in the following way:</p>
<table><thead><tr><th></th><th></th></tr></thead><tbody>
<tr><td>MAJOR</td><td>version when you make incompatible API changes</td></tr>
<tr><td>MINOR</td><td>version when you add functionality in a backwards compatible manner</td></tr>
<tr><td>PATCH</td><td>version when you make backwards compatible bug fixes.</td></tr>
</tbody></table>
<p>You may want to use additional labels for pre-release or other code as
extensions to the <code>vMAJOR.MINOR.PATCH</code> format.</p>
<blockquote>
<p>Make sure your pull request is up-to-date with main before merging and
creating a release.</p>
</blockquote>
<p>To create a release on GitHub:</p>
<ol>
<li>
<p>Decide on a tag number following the convention
<code>vMAJOR.MINOR.PATCH</code></p>
</li>
<li>
<p>Update the CHANGELOG.rst with the tag and a brief desciption of the
changes.</p>
</li>
<li>
<p>Change the version in <code>conf.py</code></p>
</li>
<li>
<p>Merge into main</p>
</li>
<li>
<p>Create a release on GitHub from the main branch, by clicking on 
<code>Draft a new release</code></p>
<p><img src="./images/new-release.png" alt="draft-new-release" /></p>
</li>
<li>
<p>Enter the tag number. Make sure the target branch is main.</p>
</li>
<li>
<p>Give the release a title and description.</p>
</li>
<li>
<p>Click publish to create the release.</p>
</li>
</ol>
<p>For a major release or critical bug-fix releases, you may want to email
the dart-users group.</p>
<blockquote>
<p>Once the code has been merged into main and released, you can delete the 
feature-branch.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="github-playground"><a class="header" href="#github-playground">GitHub Playground</a></h1>
<p>Ideal-rotary-phone is a no-consequence repo for trying out GitHub
features. It is a good place to practice branching and pull reviews.</p>
<p>The repository is visible only to members of the DART GitHub
team and the occcasional intern or student.</p>
<p><a href="https://github.com/NCAR/ideal-rotary-phone">https://github.com/NCAR/ideal-rotary-phone</a></p>
<p>The content is consciously quite silly. This is s to keep the focus on
git and GitHub without having to think about creating sensible code.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dealing-with-users"><a class="header" href="#dealing-with-users">Dealing with users</a></h1>
<p>Users are people who use DART. They may also develop their own code and/or scripts.</p>
<p>There are several ways users can communicate with us. </p>
<ul>
<li>User support requests emailed dart@ucar.edu</li>
<li>Direct email/meeting with DAReS staff</li>
<li><a href="https://github.com/NCAR/DART/issues">GitHub issues</a></li>
<li><a href="https://github.com/NCAR/DART/discussions">GitHub discussions</a></li>
</ul>
<p>GitHub issues are for bug reports and features for the code. If people are using GitHub
issues for support requests, direct the user to dart@ucar.edu and close the issue.
If a GitHub issue is not a clear issue or feature request, you can convert the issue to a 
discussion.</p>
<p>Things we do not have:</p>
<ul>
<li>ticketing system (e.g. an email to dart@ucar.edu creates a ticket)</li>
<li>user forum</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="user-reported-problems"><a class="header" href="#user-reported-problems">User reported problems</a></h1>
<p>Here are some tips for working with users when they are reporting problems:</p>
<p>Find out which version of DART a person is using. Ask them to send you the output of</p>
<pre><code>git describe --tags
</code></pre>
<p>The output will look something like this:</p>
<pre><code>v11.4.0-1-ge74ab9573
</code></pre>
<p>In this example:<br />
version: v11.4.1<br />
number of commits the user has made to this version: 1</p>
<p>So the user has made and committed changes to DART.</p>
<p>Note the use of <code>--tags</code> in the git describe command. GitHub releases are lightweight tags, rather 
than annotated tags.  If you omit the <code>--tags</code> you'll get the number of commits since the last 
annotated tag:</p>
<pre><code>v9.12.refactored-1933-g27f85ee47
</code></pre>
<p>If the user reports the message is</p>
<pre><code>fatal: No names found, cannot describe anything.
</code></pre>
<p>There are no tags in the repo. The user has forked dart with only the main branch, no branches
or tags.  Ask the user to send the output of <code>git log</code> to get some information on which version
of the code they are using.</p>
<blockquote>
<p>be aware that we occasionally have users who are still using a version of
DART checked out from an svn repositiory.</p>
</blockquote>
<p>The default option for GitHub forks is main branch only.  Unfortunately this means the 
tags are not part of the fork when using the default options:</p>
<p><img src="images/default-main-only.png" alt="main-only" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="github-actions"><a class="header" href="#github-actions">GitHub Actions</a></h1>
<p><a href="(https://docs.github.com/en/actions/quickstart)">GitHub Actions</a> is a software development automation platform that is integrated into GitHub repositories. The platform allows for the creation of several types of automated tasks such as build, test, and deploy. A set of these tasks is referred to as a <a href="./github-actions-workflow.html">workflow</a>.</p>
<p>DART utilizes GitHub Actions to run automated tests when a pull request is submitted.
The workflow is called <code>action_on_pull_request.yml</code>.
The current tests are building and running lorenz_96 (mpi) and lorenz_63 (no mpi).</p>
<blockquote>
<p>A pull request can not be merged until the tests pass.</p>
</blockquote>
<p><img src="images/actions.png" alt="actions" /></p>
<p>You can view the details of each GitHub action by clicking on <code>Details</code></p>
<p><img src="images/details.png" alt="details" /></p>
<blockquote>
<p>The tests run on <em>every</em> commit to a pull request, so it is important that the tests run quickly.  The readthedocs documentation build takes ~89 seconds.</p>
<p>Aim to beat 89s with any tests you add.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="workflows"><a class="header" href="#workflows">Workflows</a></h1>
<p>GitHub Actions workflows are configured with <code>YAML</code> files. </p>
<p>Example GitHub Actions <code>YAML</code> file:</p>
<pre><code class="language-yaml">name: Example GitHub Actions YAML Structure
run-name: ${{ github.actor }} triggered workflow via Push

on: push                                     # trigger workflow on Push to repo

jobs:
  echo-hello-world:                          # name of current workflow job
    runs-on: ubuntu-latest                   # choose operation system for workflow to run on
    steps:
      - name: Echo 'Hello World!' to shell   # Divide instruction sets by categories or 'names'
        run: echo 'Hello World!'             # 'run' label executes the paired value in the runner shell
</code></pre>
<p>Workflow <code>YAML</code> files must be placed inside the repository's <code>.github/workflows/</code> directory.
Results and logs of your workflows are located in the <a href="https://github.com/NCAR/DART/actions">'Actions' tab</a> of your GitHub Repository.</p>
<p>This document only aims to give a brief overview of GitHub action workflows. For indepth documentation visit <a href="https://docs.github.com/en/actions/using-workflows/about-workflows">docs.github.com</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="workflow-triggers"><a class="header" href="#workflow-triggers">Workflow Triggers</a></h1>
<p>GitHub Actions contains many possible triggers for starting your workflows. </p>
<p>Example trigger events to start your workflow include:</p>
<ul>
<li>on push</li>
<li>on pull requests
<ul>
<li>opening/closing</li>
<li>subsequent commits to pull requests</li>
<li>ready_for_review</li>
</ul>
</li>
<li>on issues
<ul>
<li>new issue creation</li>
<li>comment added to an issue</li>
<li>closing of an issue</li>
</ul>
</li>
<li>on fork</li>
</ul>
<p>DART's <code>action_on_pull_request.yml</code> workflow is triggered upon the creation and reopening of any pull requests to DART. Additionally, the <code>synchronize</code> type specifies that the workflow should be triggered for any subsequent commits made to the pull request branch.</p>
<pre><code class="language-yaml">on:
  pull_request:
    types: [ opened, reopened, synchronize, ready_for_review ]
</code></pre>
<p>More event trigger options can be found <a href="https://docs.github.com/en/actions/using-workflows/triggering-a-workflow">here</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="workflow-runners"><a class="header" href="#workflow-runners">Workflow Runners</a></h1>
<p>Runners are the machines that execute jobs in a GitHub Actions workflow. Runners are hosted by GitHub and what is available depends on the GitHub orgainizaion tier ($$$). Each <a href="workflow-jobs.html">workflow job</a> must specify their runner instance type.</p>
<p>The runners is specified by <code>runs-on:</code>  and can be chosen from this list of <a href="https://docs.github.com/en/actions/using-github-hosted-runners/about-github-hosted-runners#supported-runners-and-hardware-resources">runner instances</a>.</p>
<p>For DART's <code>action_on_pull_request.yml</code> workflow, the instance chosen is <code>ubuntu-latest</code> which loads an Ubuntu operating system on into your runner. </p>
<pre><code class="language-yaml">runs-on: ubuntu-latest                  # runner type
    container:                          # specifies a container to run on top of runner
      image: hkershaw/dart-dep:1.0      # uses dart-dep:1.0 container that is pulled from Dockerhub
      options: &quot;--cap-add=SYS_PTRACE&quot;   # nasty argument required for OpenMPI to work correctly in containers
</code></pre>
<p>At the time of writing, Linux-based runners have:</p>
<ul>
<li>2 x84_64 CPU cores</li>
<li>7 GB of RAM</li>
<li>14 GB of local scratch storage</li>
</ul>
<p>The pull request workflow also loads pre-built Docker container that is hosted on Dockerhub. The usage of a container here is for speed. The libraries that DART depend on, netcdf and mpi, are installed in the container. The recipes for <a href="containers.html">DART Docker containers</a> are stored in the <a href="https://github.com/NCAR/DART-containers">DART-containers</a>, while the pre-built container image is hosted and pulled from the Dockerhub repository <a href="https://hub.docker.com/repository/docker/hkershaw/dart-dep/general">hkershaw/dart-dep:1.0</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="workflow-jobs"><a class="header" href="#workflow-jobs">Workflow Jobs</a></h1>
<p>Workflow jobs are the specific sets of tasks that can be configured to run on your workflow. Multiple jobs with potentially different runner instance types can be configured to run in your workflow.</p>
<blockquote>
<p>Important: multiple jobs are run parallelly on <strong>separate</strong> runner instances. One job cannot see the details of another job. However, job dependencies can be configured in your workflow (<a href="https://docs.github.com/en/actions/using-jobs/using-conditions-to-control-job-execution">Using conditions to control job executions</a>).</p>
</blockquote>
<p>GitHub Actions offer additional design options for running multiple parallel jobs such as <a href="https://docs.github.com/en/actions/using-jobs/using-a-matrix-for-your-jobs">job matrices</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="workflow-testing"><a class="header" href="#workflow-testing">Workflow Testing</a></h1>
<p>When developing a workflow, it is a good idea to create a separate repository for development as to not disturb anyone that follows the main repository. For DART, there exists the following test repository, <a href="https://github.com/NCAR/github-actions-test">https://github.com/NCAR/github-actions-test</a>, to develop and test-run your workflows. </p>
<p>As you develop your workflow, you will notice that for test-runs, there will be a lot (potentially 100s) of commits made to your workflow feature branch. As a result, it is a good idea to rebase and square the commits made before merging into the main branch.</p>
<p>There are open-sourced tools available that help with the development process and even allow for workflows to run locally on your machine for testing:</p>
<ul>
<li><a href="https://github.com/nektos/act">https://github.com/nektos/act</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tidbits"><a class="header" href="#tidbits">Tidbits</a></h1>
<ul>
<li>using a <code>YAML</code> validator available online (<a href="https://jsonformatter.org/yaml-validator">such as this</a>) is instrumental for catching syntactical errors with <code>YAML</code> files</li>
<li>after each <code>run:</code> step, you will be placed back to the top-most directory of the runner and will have to <code>cd</code> back to your working directory if you split your tasks across multiple <code>run:</code> steps.</li>
<li>for every run of a GitHub Actions workflow, a GitHub token is generated for the runner instances to use such that it is able to perform tasks such as checking out your repo. For DART, the default permissions of the generated GitHub token has been set  to read-only, however, it can be changed in a workflow. If your workflow requires additional permissions, consult with someone about if it is necessarily needed.</li>
<li>the following pages are useful for securing your workflow:
<ul>
<li><a href="https://docs.github.com/en/actions/security-guides/automatic-token-authentication">https://docs.github.com/en/actions/security-guides/automatic-token-authentication</a></li>
<li><a href="https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions">https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions</a></li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="composite-actions"><a class="header" href="#composite-actions">Composite Actions</a></h1>
<p>Composite GitHub Actions are re-useable and shareable bits that can be packaged and inserted into workflows.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="requirements"><a class="header" href="#requirements">Requirements</a></h1>
<p>Composite actions have the following structural requirements:</p>
<p>If the composite action is hosted within the main repository </p>
<ul>
<li>a directory that signifies the name of the composite action is located in <code>.github/actions/</code></li>
<li>inside that directory <strong>must</strong> exist a file named <code>action.yml</code></li>
</ul>
<p>For DART's <code>build_run_model</code> composite action, its path in DART is: <code>.github/actions/build_run_model</code>.<br />
The location of the <code>action.yml</code> is <code>.github/actions/build_run_model/action.yml</code>.</p>
<p>If you decide to host your composite action as its own GitHub repository:</p>
<ul>
<li>the name of the repository is the name of the composite action</li>
<li>an <code>action.yml</code> file <strong>must</strong> exist in the top-most directory of the repository</li>
</ul>
<p>For an example of a GitHub hosted composite action, see <a href="https://github.com/actions/checkout">actions/checkout</a>'s repo, which is a composite action commonly used for checking out a GitHub repository into your GitHub Actions' runner instance.</p>
<p>This document will go over an example of how the composite action <code>build_run_model</code> is used inside the workflow <code>action_on_pull_request.yml</code> in <a href="https://github.com/NCAR/DART/tree/main/.github/actions">DART/.github/actions/</a>.</p>
<p>For a more detailed documentation, take a look at GitHub's getting started guide for composite actions: <a href="https://docs.github.com/en/actions/creating-actions/creating-a-composite-action">https://docs.github.com/en/actions/creating-actions/creating-a-composite-action</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="usage"><a class="header" href="#usage">Usage</a></h1>
<p>Before going over the specifics of how a composite action is constructed, let's first take a look at how a composite action is used inside a workflow.</p>
<p>Inside <code>action_on_pull_request.yml</code>:</p>
<pre><code class="language-yaml">jobs:
  build-run-lorenz_96:
    [...]
    steps:
    - name: Checkout repo into runner instance
      uses: actions/checkout@v3 
</code></pre>
<p>Invocation of a composite action is done by the <code>uses:</code> key. In the above example, the publically available <code>checkout</code> composite action is being invoked. When using a hosted composite action, the syntax is <code>&lt;username&gt;/&lt;composite_name&gt;[@v&lt;release-version&gt;]</code>. For the above case, we are using version 3 of the <code>checkout</code> composite action.</p>
<p>If the composite action being used has input parameters available, then invoking that action would look like this:</p>
<pre><code class="language-yaml">jobs:
  build-run-lorenz_96:
    [...]
    steps:
    - name: Checkout repo into runner instance
      uses: actions/checkout@v3                 # invoking remotely hosted composite action
      with:                                     # for specifiying arguments passed to composite action
        path:  ...                              # specify the path for checkout action to be performed in  
        token: ...                              
</code></pre>
<p>where values assigned to the keys <code>path</code> &amp; <code>token</code> would be passed to the composite action to be used.</p>
<p>If the composite action exists locally within your repository (inside <code>.github/actions/[composite_action_dir]</code>), invoking the composite would look like the following:</p>
<pre><code class="language-yaml">jobs:
  build-run-lorenz_96:
    [...]
    steps:
      [...]
      - name: Build and run lorenz_96
        uses: ./.github/actions/build_run_model
        with: 
          model: lorenz_96
          run-program: ./filter
          use-mpi: true
          mpi-n-tasks: 2
</code></pre>
<p>For local composite actions, the <code>uses</code> key requires a full path from repository directory to the directory of your composite action containing the <code>action.yml</code> file. </p>
<p>As the example indicates, the composite action <code>build_run_model</code> is being invoked with four arguments: <code>model</code>, <code>run-program</code>, <code>use-mpi</code>, and <code>mpi-n-tasks</code>. A composite action may contain arguments that are not required to be specified upon invocation.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="actionyml-file"><a class="header" href="#actionyml-file">action.yml File</a></h1>
<p>Now that we've taken a looked at how composite actions can be called, let's look at how the composite action file <code>action.yml</code> is constructed. Specifically, <code>build_run_model</code>'s <code>action.yml</code>.</p>
<pre><code class="language-yaml">name: 'Build and run model'
description: 'Build and run given model'

# All possible input parameters that can be specified when using this composite action
inputs:
  models-directory:
    description: 'path to top-level directory containing the model to build and run'
    type: string
    required: false
    default: 'models/'
  model: 
    description: 'name of existing DART model'
    type: string
    required: true
    default: 'lorenz_96'
  [...]
</code></pre>
<p>Near the top of <code>action.yml</code>, is where the different input parameters are located. To references an argument passed to the composite action from a workflow, the syntax will look as follows: <code>${{ inputs.&lt;parameter_name&gt; }}</code>. </p>
<p>Following the specified possible input parameters, is the meat of composite actions.</p>
<pre><code class="language-yaml">runs:
  using: &quot;composite&quot;
  steps:
    # Steps to create Makefile template
    - name: Creating Makefile template :)
      run: |
        cd build_templates
        cp mkmf.template.gfortran mkmf.template
        echo 'FFLAGS = -g -Wuninitialized -Wunused -ffree-line-length-none -fbounds-check -fbacktrace -ffpe-trap=invalid,zero,overflow $(INCS)' &gt;&gt; mkmf.template
      shell: bash
    # Steps to compile and build model
    - name: Building ${{ inputs.model }} model
      run: |
        cd ${{ inputs.models-directory }}/${{ inputs.model }}/work
        ./quickbuild.sh
      shell: bash
  [...]
</code></pre>
<p>A composite action is initially defined the <code>using: &quot;composite&quot;</code> line after the <code>run:</code> label. A composite action is almost like a giant <code>run:</code> instruction from <a href="./github-actions-workflow.html">workflows</a>, but is more flexible with the use of input parameters. One key point to make is that <code>shell: bash</code> has to be specified for each run <code>step:</code> inside a composite action. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dart-docker-containers"><a class="header" href="#dart-docker-containers">DART Docker Containers</a></h1>
<p>DART Docker files are stored in the <a href="https://github.com/NCAR/DART-containers.git">DART-containers</a> repo. </p>
<p>If you add containers to this repo, follow the convention of </p>
<blockquote>
<p>one Dockerfile per directory.</p>
</blockquote>
<p>NCAR has a dockerhub organization, but has used up its allotted number of users.  Possibly at some point NCAR will increase their dockerhub licenses. </p>
<p>DART Docker images are hosted on the <a href="https://hub.docker.com/repositories/hkershaw">hkershaw</a> dockerhub.<br />
If we make more use of containers, we may need to look at creating a DART organization.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dart-web-presence"><a class="header" href="#dart-web-presence">DART web presence</a></h1>
<p>There are two components to the DART web presence:</p>
<ul>
<li>The <a href="./documentation.html">documentation</a> which is built from the .rst files in the main branch</li>
<li>The <a href="./website.html">DART website</a> which is built from the private repo <a href="https://github.com/NCAR/dart-web">dart-web</a>
and served thought the github pages branch on https://github.com/NCAR/DART. </li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dart-documentation"><a class="header" href="#dart-documentation">DART Documentation</a></h1>
<p>The documentation for DART is written in reStructuredText, then
converted to html using Sphinx. The conversion to html is done
automatically by readthedocs, when new content is pushed to a branch.</p>
<p>Documentation is built for pull requests.  You can view the documentation
build by clicking on <code>show all checks</code> then <code>details</code>.</p>
<p><img src="./images/doc-pull-req.png" alt="doc-pull" /></p>
<p>You can build the DART documentation locally using Sphinx.</p>
<h3 id="installing-sphinx-locally"><a class="header" href="#installing-sphinx-locally">Installing Sphinx Locally</a></h3>
<p>To install Sphinx in a Python virtual environment:</p>
<pre><code>python -m venv dev-guide
source dev-guide/bin/activate
pip install Sphinx==6.2.1
pip install sphinx-rtd-theme==1.2.2
</code></pre>
<p>Copy the following example Makefile to your machine. </p>
<p>Change the SOURCEDIR line to match where you have DART checked out.</p>
<pre><code># Minimal makefile for Sphinx documentation
#

# You can set these variables from the command line, and also
# from the environment for the first two.
SPHINXOPTS    ?= -n
SPHINXBUILD   ?= sphinx-build
SOURCEDIR     = /Users/hkershaw/DART/Refactor/Build_system/DART.buildit
BUILDDIR      = dart-docs

# Put it first so that &quot;make&quot; without argument is like &quot;make help&quot;.
help:
	@$(SPHINXBUILD) -M help &quot;$(SOURCEDIR)&quot; &quot;$(BUILDDIR)&quot; $(SPHINXOPTS) $(O)

.PHONY: help Makefile

# Catch-all target: route all unknown targets to Sphinx using the new
# &quot;make mode&quot; option.  $(O) is meant as a shortcut for $(SPHINXOPTS).
%: Makefile
	@$(SPHINXBUILD) -M $@ &quot;$(SOURCEDIR)&quot; &quot;$(BUILDDIR)&quot; $(SPHINXOPTS) $(O)
</code></pre>
<p>To make the docs, run:</p>
<pre><code>make html
</code></pre>
<p>To view the docs:</p>
<pre><code>open dart-docs/html/README.html 
</code></pre>
<p>with your favorite browser.</p>
<p>To deactivate the virtual environment</p>
<pre><code>deactivate

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dart-website"><a class="header" href="#dart-website">DART website</a></h1>
<p>There are two repositories to be aware of for the DART website:</p>
<p><a href="https://github.com/NCAR/dart-web.git">https://github.com/NCAR/dart-web.git</a> Is the private repository used to build
the site.</p>
<p>The website is hosted via GitHub pages at <a href="https://dart.ucar.edu">https://dart.ucar.edu</a>.</p>
<p>For instructions on building the website, read the README at
<a href="https://github.com/NCAR/dart-web">https://github.com/NCAR/dart-web</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contributors"><a class="header" href="#contributors">Contributors</a></h1>
<ul>
<li><a href="https://github.com/hkershaw-brown">Helen Kershaw</a></li>
<li><a href="https://github.com/achauphan">Anderson Chauphan</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
